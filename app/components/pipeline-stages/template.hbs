<section class="pipeline-stages">
  <div class="stages-line"></div>
  {{#if stagesDraggable}}
    {{#sortable-objects useSwap=true sortableObjectList=model sortEndAction='sortEndAction' enableSort=true sortingScope="sortingGroup"}}
      {{#each model as |item index|}}
        {{#draggable-object isDraggable=true dragHandle='.js-dragHandle' class="stage-wrap" content=item overrideClass='sortObject' isSortable=true sortingScope="sortingGroup"}}
            <div class="stage-name text-muted clip">
              {{index-add index}}. {{item.name}}
            </div>
            {{pipeline-steps 
              stageIndex=(index-add index) 
              stageInfo=item.name 
              model=item.steps 
              stageId=item.name 
              stepsDraggble=true 
              editable=editable 
              stagesDraggable=stagesDraggable
              stepMode=(if (eq index 0) 'scm' '')
              editMode=editMode
            }}
        {{/draggable-object}}
      {{/each}}
      <div class="stage-wrap">
        <div class="stage-name text-muted">
          {{t 'pipelinesPage.newStage'}}
        </div>
        <div class="pipeline-steps">
          <div class="steps-line"></div>
          <div class="steps-head-dot"></div>
          <div class="steps-wrap">
            <div class="step-content big" {{action 'addStage'}}>
              {{t 'pipelinesPage.addStage'}}
            </div>
          </div>
        </div>
      </div>
    {{/sortable-objects}}
    
  {{else}}
    {{#each model as |item index|}}
    <div class="stage-wrap">
      <div class="stage-name text-muted clip">
        {{index-add index}}. {{item.name}}
      </div>
      {{pipeline-steps 
        stageIndex=(index-add index) 
        stageInfo=item.name 
        model=item.steps 
        stageId=item.name 
        stpesDraggable=false 
        stagesDraggable=stagesDraggable 
        editable=editable 
        stepMode=(if (eq index 0) 'scm' '')
        editMode=editMode
        }}
    </div>
    {{/each}}
  {{/if}}
</section>

